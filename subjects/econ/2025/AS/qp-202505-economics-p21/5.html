<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Econ Q5: Fiscal Policy</title>
    
    <link rel="stylesheet" href="../../../../../common/css/style.css">
    
    <!-- MathJax -->
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        body { padding-top: 60px; padding-bottom: 40px; background-color: #f4f7f6; max-width: none !important; }
        
        .container {
            width: 98%; max-width: 1600px; margin: 0 auto;
            display: grid; grid-template-columns: 1fr 450px; 
            gap: 20px; align-items: start;
        }
        @media (max-width: 1000px) { .container { grid-template-columns: 1fr; } }

        .card { background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
        
        .back-arrow {
            position: fixed; top: 15px; left: 15px; z-index: 9999;
            width: 40px; height: 40px; background: rgba(255,255,255,0.9);
            border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center;
            text-decoration: none; color: #333; font-size: 24px; font-weight: bold;
            font-family: sans-serif; line-height: 1; cursor: pointer;
        }
        
        .orig-img { max-width: 100%; display: block; margin-bottom: 10px; border: 1px solid #eee; }

        /* 画布 */
        .canvas-container { 
            width: 100%; height: 400px; 
            position: relative; background: #fff; border: 1px solid #ddd; 
            border-radius: 8px; margin-bottom: 15px; overflow:hidden; 
        }
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        
        .controls { 
            display: flex; flex-direction: column; gap: 12px; 
            background: #f8f9fa; padding: 15px; border-radius: 8px; border:1px solid #eee;
        }
        .control-row { display: flex; align-items: center; gap: 10px; justify-content: space-between; }
        
        button.action-btn { 
            flex: 1; background-color: #fff; color: #333; border: 1px solid #ccc; 
            padding: 8px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size:13px;
        }
        button.action-btn.active { background-color: #2980b9; color: white; border-color: #2980b9; }
        button.exam-btn { background-color: #27ae60; color: white; border: none; flex: 2; }
        
        /* 右侧面板 */
        .solution-panel { max-height: 85vh; overflow-y: auto; padding-right: 5px; }
        .tabs { display: flex; border-bottom: 2px solid #eee; margin-bottom: 15px; }
        .tab-item { padding: 10px 15px; cursor: pointer; font-weight: bold; color: #7f8c8d; border-bottom: 2px solid transparent; margin-bottom: -2px; font-size: 14px; }
        .tab-item.active { color: #3498db; border-bottom-color: #3498db; }
        
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
        
        .explanation p { margin-bottom: 8px; line-height: 1.6; font-size: 14px; color: #444; }
        .term { color: #d35400; font-weight: bold; }
        .highlight { background-color: #fff3cd; padding: 1px 4px; border-radius: 3px; font-weight:bold; color:#d35400; }
        h4 { margin: 15px 0 8px 0; color: #2c3e50; border-left: 4px solid #3498db; padding-left: 8px; font-size: 15px; }
        
        .model-section { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px dashed #ccc; }
        .model-header { font-size: 16px; font-weight: bold; color: #2980b9; margin-bottom: 8px; }
        .model-sub { font-weight: bold; color: #555; display: block; margin-top: 8px; }
        
        .problem-text { background:#e8f4fd; padding:15px; border-left:4px solid #3498db; margin-bottom:15px; font-size:15px; line-height:1.6; color:#333; }
    </style>
</head>
<body>

    <a href="javascript:history.back()" class="back-arrow">‹</a>

    <div class="container">
        <div class="left-col">
            <div class="card">
                <h3 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">9708 Econ / Section C / Q5</h3>
                
                <div class="problem-text">
                    <!-- 图片占位 (虽然这题是纯文字，但保留结构) -->
                    <img src="q5_orig.png" class="orig-img" onerror="this.style.display='none'">
                    <p><strong>(a)</strong> Explain the difference between a budget surplus and a budget deficit and consider the extent to which a budget surplus is better than a budget deficit. [8]</p>
                    <p><strong>(b)</strong> Assess whether expansionary fiscal policy always benefits an economy. [12]</p>
                </div>

                <div class="canvas-container">
                    <canvas id="simCanvas"></canvas>
                    <div style="position:absolute; top:10px; right:10px; background:rgba(255,255,255,0.9); padding:8px; border-radius:4px; font-size:12px; border:1px solid #eee;">
                        <div style="color:#2980b9">● AD (Aggregate Demand)</div>
                        <div style="color:#c0392b">● AS (Aggregate Supply)</div>
                        <div style="color:#e67e22">● LRAS (Full Employment)</div>
                    </div>
                </div>

                <div class="controls">
                    <div class="control-row">
                        <span style="font-weight:bold; font-size:14px;">Fiscal Policy (G/T):</span>
                        <input type="range" id="sliderG" min="0" max="100" value="20" style="flex:1; cursor:pointer;" oninput="manualMode()">
                    </div>
                    <div style="display:flex; justify-content:space-between; font-size:12px; color:#666; margin-top:-8px;">
                        <span>Contractionary</span>
                        <span>Expansionary</span>
                    </div>
                    
                    <div class="control-row" style="margin-top:10px;">
                        <button class="action-btn exam-btn" onclick="showExamMode()">★ Show Expansionary Effect</button>
                        <button class="action-btn" style="background:#95a5a6; color:white; flex:0.3;" onclick="resetGraph()">Reset</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="right-col">
            <div class="card solution-panel">
                <div class="tabs">
                    <div class="tab-item active" onclick="switchTab('a')">Part (a) Logic</div>
                    <div class="tab-item" onclick="switchTab('b')">Part (b) Logic</div>
                    <div class="tab-item" onclick="switchTab('model')">Full Answer</div>
                </div>

                <!-- Part A -->
                <div id="tab-a" class="tab-content active">
                    <h4>1. Definitions (AO1)</h4>
                    <div class="explanation">
                        <ul>
                            <li><strong>Budget Surplus:</strong> Gov Revenue (Tax) > Gov Spending ($T > G$).</li>
                            <li><strong>Budget Deficit:</strong> Gov Spending > Gov Revenue ($G > T$).</li>
                        </ul>
                    </div>
                    <h4>2. Comparison (AO2/AO3)</h4>
                    <div class="explanation">
                        <p><strong>Surplus Pros:</strong> Reduces national debt, controls inflation (contractionary).</p>
                        <p><strong>Deficit Pros:</strong> Stimulates AD (Expansionary), reduces unemployment, funds infrastructure.</p>
                        <p><span class="highlight">Judgement:</span> A surplus isn't always "better". During a recession, a deficit is necessary to boost growth.</p>
                    </div>
                </div>

                <!-- Part B -->
                <div id="tab-b" class="tab-content">
                    <h4>1. Expansionary Policy (Benefits)</h4>
                    <div class="explanation">
                        <p>• $\uparrow G$ or $\downarrow T \Rightarrow \uparrow AD$.</p>
                        <p>• <strong>Higher Growth:</strong> Real GDP increases ($Y \rightarrow Y_1$).</p>
                        <p>• <strong>Lower Unemployment:</strong> More labor needed for output.</p>
                    </div>
                    <h4>2. Drawbacks (Evaluation)</h4>
                    <div class="explanation">
                        <p>• <span class="term">Inflation:</span> If AD rises near full capacity (LRAS), Price Level rises ($P \rightarrow P_1$). (See Diagram)</p>
                        <p>• <span class="term">National Debt:</span> financed by borrowing.</p>
                        <p>• <span class="term">Crowding Out:</span> Gov borrowing raises interest rates, reducing private investment.</p>
                    </div>
                </div>

                <!-- Model Answer -->
                <div id="tab-model" class="tab-content">
                    <div class="explanation" style="font-family: Georgia, serif; font-size:15px;">
                        
                        <div class="model-section">
                            <div class="model-header">Part (a) [8 Marks]</div>
                            <p>A <span class="term">budget surplus</span> occurs when tax revenue ($T$) exceeds government spending ($G$). A <span class="term">budget deficit</span> occurs when $G > T$.</p>
                            <span class="model-sub">Evaluation:</span>
                            <p>A surplus is not always "better". While it reduces national debt, a large surplus withdraws demand from the economy, potentially slowing growth. Conversely, a deficit acts as a stimulus (via the Multiplier) which is beneficial during a recession to reduce unemployment.</p>
                        </div>

                        <div class="model-section" style="border-bottom:none;">
                            <div class="model-header">Part (b) [12 Marks]</div>
                            <p>Expansionary fiscal policy involves increasing $G$ or reducing $T$ to shift Aggregate Demand (AD) to the right.</p>
                            <span class="model-sub">Benefits (Analysis):</span>
                            <p>As shown in the diagram (use 'Show Exam Effect'), shifting AD right leads to an increase in Real GDP ($Y$ to $Y_1$). This reduces cyclical unemployment as firms hire more labor to meet demand.</p>
                            <span class="model-sub">Evaluation (Does it always benefit?):</span>
                            <p>However, if the economy is near full capacity (LRAS), the shift in AD mainly causes <span class="highlight">demand-pull inflation</span> ($P$ rises to $P_1$) rather than real growth. Furthermore, financing the deficit may lead to <strong>crowding out</strong> of private investment.</p>
                            <span class="model-sub">Conclusion:</span>
                            <p>It benefits an economy in recession (spare capacity) but can be harmful (inflationary) if the economy is already overheating.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        
        // Graph State: AD Shift
        let shiftAD = 0; 
        let isExamMode = false;

        function resize() {
            if(!canvas.parentElement) return;
            canvas.width = canvas.parentElement.clientWidth;
            canvas.height = 400; 
            width = canvas.width; height = canvas.height;
            draw();
        }
        window.addEventListener('resize', resize);
        window.addEventListener('load', resize);

        function manualMode() { 
            isExamMode = false; 
            shiftAD = parseInt(document.getElementById('sliderG').value); 
            draw(); 
        }

        function showExamMode() { 
            isExamMode = true; 
            shiftAD = 70; // Significant shift
            document.getElementById('sliderG').value = 70;
            draw(); 
        }

        function resetGraph() { 
            isExamMode = false; 
            shiftAD = 20; // Reset to initial low AD
            document.getElementById('sliderG').value = 20; 
            draw(); 
        }
        
        function switchTab(id) {
            document.querySelectorAll('.tab-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            const index = id==='a'?0:(id==='b'?1:2);
            document.querySelectorAll('.tab-item')[index].classList.add('active');
            document.getElementById('tab-'+id).classList.add('active');
        }

        function draw() {
            if(!width) return;
            ctx.clearRect(0,0,width,height);
            const p=40; // padding
            const origin = {x: p, y: height-p};
            
            // Axes
            ctx.beginPath(); ctx.strokeStyle='#333'; ctx.lineWidth=2;
            ctx.moveTo(origin.x, 20); ctx.lineTo(origin.x, origin.y); ctx.lineTo(width-20, origin.y); ctx.stroke();
            ctx.font='bold 14px Arial'; ctx.fillStyle='#333';
            ctx.fillText("Price Level (PL)", 10, 15); ctx.fillText("Real GDP (Y)", width-100, origin.y-10);

            // LRAS (Vertical Line at 80% width)
            const lrasX = origin.x + (width-2*p)*0.8;
            ctx.beginPath(); ctx.strokeStyle='#e67e22'; ctx.lineWidth=3;
            ctx.moveTo(lrasX, 20); ctx.lineTo(lrasX, origin.y); ctx.stroke();
            ctx.fillStyle='#e67e22'; ctx.fillText("LRAS (Yfe)", lrasX-30, 35);

            // SRAS (Upward sloping)
            const srasStart = {x: origin.x, y: origin.y - (height-2*p)*0.2};
            const srasEnd = {x: width-p, y: 20};
            // To make it curve up near LRAS
            ctx.beginPath(); ctx.strokeStyle='#c0392b';
            ctx.moveTo(srasStart.x, srasStart.y);
            // Curve point
            ctx.quadraticCurveTo(lrasX*0.8, origin.y, lrasX, 20);
            ctx.stroke();
            ctx.fillStyle='#c0392b'; ctx.fillText("SRAS", lrasX-40, 100);

            // AD Curve (Downward sloping)
            // Base Position
            const baseADX = origin.x + (width-2*p)*0.2; 
            // Shift based on slider (0 to 100) -> maps to x pixel shift
            const maxShift = (width-2*p)*0.5;
            const currentShift = (shiftAD/100) * maxShift;
            
            const adTop = {x: baseADX + currentShift, y: 20};
            const adBot = {x: baseADX + currentShift + (width*0.4), y: origin.y};
            
            ctx.beginPath(); ctx.strokeStyle='#2980b9';
            ctx.moveTo(adTop.x, adTop.y); ctx.lineTo(adBot.x, adBot.y); ctx.stroke();
            ctx.fillStyle='#2980b9'; ctx.fillText(isExamMode?"AD2":"AD", adTop.x, adTop.y+20);

            // Original AD (Phantom) if Exam Mode
            if(isExamMode) {
                const ghostTop = baseADX + (20/100)*maxShift;
                const ghostBot = ghostTop + (width*0.4);
                ctx.save();
                ctx.setLineDash([5,5]); ctx.strokeStyle='rgba(41, 128, 185, 0.3)';
                ctx.beginPath(); ctx.moveTo(ghostTop, 20); ctx.lineTo(ghostBot, origin.y); ctx.stroke();
                ctx.fillStyle='rgba(41, 128, 185, 0.5)'; ctx.fillText("AD1", ghostTop, 40);
                ctx.restore();
                
                // Arrow
                drawArrow(ghostTop+50, 100, adTop.x+50, 100);
            }

            // Visual Feedback (Inflation vs Growth)
            // Simple intersection logic: simplified linear intersection visual
            // Approximate intersection with SRAS
            let intersectX = (adTop.x + adBot.x)/2; // Roughly middle of AD
            // Clamp to LRAS
            if(intersectX > lrasX) intersectX = lrasX;
            
            // Draw Equilibrium Point
            let intersectY = origin.y - (intersectX / width) * (height*0.8); // Rough height
            // Correction: Curve logic is hard to inverse precisely without math lib, using visual approx
            
            // Dynamic Feedback Text
            ctx.font='14px Arial';
            if(shiftAD < 40) {
                ctx.fillStyle='#27ae60'; ctx.fillText("✅ Boosting Growth (Y↑)", origin.x+20, 60);
            } else if (shiftAD > 70) {
                ctx.fillStyle='#e74c3c'; ctx.fillText("⚠️ High Inflation! (PL↑↑)", origin.x+20, 60);
                ctx.fillText("   Capacity Constraint Reached", origin.x+20, 80);
            }
        }
        
        function drawArrow(x1, y1, x2, y2) {
            const head = 10; const angle = Math.atan2(y2-y1, x2-x1);
            ctx.beginPath(); ctx.moveTo(x1, y1); ctx.lineTo(x2, y2); ctx.strokeStyle='#333'; ctx.lineWidth=2; ctx.stroke();
            ctx.beginPath(); ctx.moveTo(x2, y2); 
            ctx.lineTo(x2-head*Math.cos(angle-Math.PI/6), y2-head*Math.sin(angle-Math.PI/6));
            ctx.lineTo(x2-head*Math.cos(angle+Math.PI/6), y2-head*Math.sin(angle+Math.PI/6));
            ctx.fillStyle='#333'; ctx.fill();
        }

        setTimeout(()=>{ resize(); resetGraph(); }, 200);
    </script>
</body>
</html>